![30](https://github.com/saikiranpi/mastering-aws/assets/109568252/00f21c0b-e7dc-4965-9494-2e484821791b)



# Cloud Watch 2: EventBridge and Lambda

This repository showcases a practical implementation of Amazon EventBridge, Lambda, and CloudWatch to capture and manage logs related to EC2 volumes. The setup involves creating EventBridge rules, Lambda functions, and utilizing CloudWatch to capture logs, with the ultimate goal of automating EC2 volume management.

## Table of Contents
- [Introduction](#introduction)
- [Architecture Overview](#architecture-overview)
- [Setup](#setup)
- [Capturing Logs](#capturing-logs)
- [Automating Volume Deletion](#automating-volume-deletion)
- [Contributing](#contributing)
- [License](#license)

## Introduction
This project demonstrates the integration of AWS EventBridge with Lambda functions to automate tasks and capture logs in CloudWatch. The key features include:
1. Capturing EC2 volume events using EventBridge.
2. Processing these events with Lambda functions.
3. Capturing logs in CloudWatch for monitoring and debugging.
4. Automating the deletion of unused EC2 volumes.

## Architecture Overview
- **EventBridge**: Captures events related to EC2 volumes (e.g., `CreateVolume`, `DeleteVolume`) and triggers Lambda functions.
- **Lambda**: Processes the events from EventBridge. One function logs the events, while another automates the deletion of unused volumes.
- **CloudWatch**: Stores logs generated by the Lambda functions, providing visibility into the events and actions taken.

## Setup
1. **EventBridge Rules**: Create rules to capture EC2 volume events.
2. **Lambda Functions**: 
   - **Log Events**: A Lambda function to print and log EC2 volume events.
   - **Delete Volumes**: Another Lambda function to automatically delete unused EC2 volumes.
3. **CloudWatch Log Groups**: Ensure logs are captured and monitored.

## Capturing Logs
1. **EventBridge Rule**: Capture events related to EC2 volumes.
2. **Lambda Function**: Process and log these events:
   ```python
   import json

   def lambda_handler(event, context):
       print(json.dumps(event))
       return {
           'statusCode': 200,
           'body': json.dumps('Event received')
       }
   ```
3. **CloudWatch**: Verify that logs are captured under the appropriate log groups.

## Automating Volume Deletion
1. **Lambda Function for Deletion**:
   ```python
   import boto3

   ec2 = boto3.client('ec2')

   def lambda_handler(event, context):
       volumes = ec2.describe_volumes(Filters=[{'Name': 'status', 'Values': ['available']}])
       for volume in volumes['Volumes']:
           ec2.delete_volume(VolumeId=volume['VolumeId'])
           print(f"Deleted volume: {volume['VolumeId']}")
   ```
2. **Permissions**: Ensure the Lambda function has the necessary EC2 permissions.
3. **Testing**: Verify the function deletes unused volumes as expected.

## Contributing
Contributions are welcome! Please submit a pull request or open an issue to discuss any changes.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---

By following this guide, you will have set up an automated system using AWS EventBridge, Lambda, and CloudWatch to manage EC2 volume events and automate volume deletion, enhancing operational efficiency and providing a practical hands-on experience with AWS services.
